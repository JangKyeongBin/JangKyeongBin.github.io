---
title : "슈트라센 알고리즘"
layout : single
categories : 
 - jekyll
 - minimal-mistakes
tags :
 - github pages
 - jekyll
 - minimal-mistakes
date : "2020-04-08 17:00"
---

### 슈트라센 알고리즘

---

$$
A=\begin{bmatrix}
A_{1,1}&A_{1,2}\\
A_{2,1}&A_{2,2}
\end{bmatrix},
B=\begin{bmatrix}
B_{1,1}&B_{1,2}\\
B_{2,1}&B_{2,2}
\end{bmatrix},
C=\begin{bmatrix}
C_{1,1}&C_{1,2}\\
C_{2,1}&C_{2,2}
\end{bmatrix},
$$

위와 같이 세개의 행렬이 있다.

A행렬과 B행렬을 곱해 C행렬을 구하고자 할 때 우리는 아래와 같은 방법을 이용했다.
$$
C_{1,1}= A_{1,1} B_{1,1} + A_{1,2} B_{2,1}\\
C_{1,2}= A_{1,1} B_{1,2} + A_{1,2} B_{2,2}\\
C_{2,1}= A_{2,1} B_{1,1} + A_{2,2} B_{2,1}\\
C_{2,2}= A_{2,1} B_{1,2} + A_{2,2} B_{2,2}
$$
이러한 방법은 단순한 2x2 행렬에서는 문제 없겠지만 n이 커질수록 계산시간은 비약적으로 증가한다.

이를 해결하고자 슈트라센은 슈트라센 알고리즘이란걸 만들었다고 한다.

#### '행렬을 쪼개서 계산하다' 라는게 기본 아이디어다.


$$
\begin{align}
M_1 &=(A_{1,1}+A_{2,2})(B_{1,1}+B_{2,2})\\
M_2 &= (A_{2,1}+A_{2,2})B_{1,1}\\
M_3 &= A_{1,1}(B_{1,2}-B_{2,2})\\
M_4 &= A_{2,2}(B_{2,1}-B_{1,1})\\
M_5 &= (A_{1,1}+A_{1,2})B_{2,2}\\
M_6 &= (A_{2,1}-A_{1,1})(B_{1,1}+B_{1,2})\\
M_7 & = (A_{1,2}-A_{2,2})(B_{2,1}+B_{2,2})\\
\end{align}
$$
여기서 M을 C에 대해 바꿔주면
$$
\begin{align}
C_{1,1}&=M_1 + M_4 - M_5 + M_7\\
C_{1,2}&=M_3 + M_5 \\
C_{2,1}&=M_2 + M_4\\
C_{2,2}&=M_1 - M_2 + M_3 + M_6\\
\end{align}
$$
증명
$$
\begin{align}
C_1&= -P_2+P_4+P_5+P_6\\
&=(-A_1B_4-A_2B_4)+P_4+(A_1B_1+A_1B_4+A_4B_1+A_4B_4)+P_6\\
&=-A_2B_4+(A_4B_3-A_4B_1)+A_1B_1+A_4B_1+A_4B_4+P_6\\
&=-A_2B_4+A_4B_3+A_1B_1+A_4B_4+(A_2B_3+A_2A_4-A_4B_3-A_4B_4)\\
&=A_1B_1+A_2B_3
\end{align}
$$

---

$$
\begin{align}
C_2=&P_1+P_2\\
=&(A_1B_2-A_1B_4)+(A_1B_4+A_2B_4)\\
=&A_1B_2+A_2B_4\\
\end{align}
$$

---

$$
\begin{align}
C_3 &= P_3+P_4\\
&=(A_3B_1+A_4B_1)+(A_4B_3-A_4B_1)\\
&=A_3B_1+A_4B_3\\
\end{align}
$$

---

$$
\begin{align}
C_4&=P_1-P_3+P_5+P_7\\
&=(A_1B_2-A_1B_4)-P_3+(A_1B_1+A_1B_4+A_4B_1+A_4B_4)+P_7\\
&=A_1B_2-A_3B_1+A_1B_1+A_4B_4+(A_3B_1+A_3B_2-A_1B_1-A_1B_2)\\
&=A_3B_2+A_4B_4\\
\end{align}
$$

---